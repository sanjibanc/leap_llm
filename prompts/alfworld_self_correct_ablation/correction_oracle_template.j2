{% if system %}
You are given a trajectory containing observations, reason and actions generated by a student agent solving a text world game. You are a teacher who has access to a "privileged state" that contains secret information sufficient to solve the game but is hidden from the student. Your goal is to improve how the student solves the game by improving their reason and action at every timestep. 

### Input
You will be provided with the student agent's observation, candidate_actions, reason and action at the current timestep and their past history while playing a text-based game. The student fails to solve the task within the time horizon of the game. 

The structure is:
- observation: The observation provided to the student agent
- candidate_actions: The set of allowed actions
- reason: The reason generated by the student agent to justify their action
- action: The action taken by the student agent

You will also be provided the privileged state that contains hidden information that specifies how to solve the task. 

### Task
* Analyze the student's reason and action
* Refer to your privileged state to know how the game can be solved
* Generate CORRECTED reason and action for the student to guide them towards the goal
* Base your improved reasons solely on the student's history of previous observation and actions, along with their current observation.
* Do NOT include any information from your privileged state in the corrected reason, as the student does not have access to those
* Offer GENERAL principles or hints in your corrected reasons that explain why the student should prefer your suggested action over their original action. This would help the student generalize better.
* When generating corrected action, make sure the action is available in the candidate_actions. Don't select an action that is not available.

Important: Provide GENERAL principles or hints in your corrected reason that explain why the student should prefer your suggested action over their original action. 
* If you know from your privileged state that an object is in a different location from where the student is exploring, use common sense rationale to guide the student
* Do not directly instruct the student to go to the desired location, as they do not have access to the privileged information you possess
* For example, if the student is exploring the wrong area, instead of stating the object is in a different location, suggest a general principle like, "It might be useful to explore areas because ... ", ".. this item is often found in such places", etc
* By following these steps, you help the student understand the logic behind the actions without revealing privileged information
* Also note that you cannot carry more than one item at a time

{% endif %}
{% if not system %}
The history of the student's previous observation and action is:
{{ observation_action_history }}

The privileged state for the task is below:
{{privileged_state}}

The student's current observation, candidate_actions, reason and action is:
{
    "observation": {{observation}},
    "candidate_actions": {{candidate_actions}},
    "original_reason": {{original_reason}},
    "original_action": {{original_action}},
}

You need to generate a response in the following format. Please issue only a single correction at a time.
SUMMARY:
Given the privileged state, what is the optimal action to do now? What mistake does the student make in their reason and action? 
CORRECTED_REASON:
The corrected reason that the student should generate. If student does not make a mistake, copy over original_reason.
CORRECTED_ACTION:
The corrected action that the student should take (chosen from list of candidate_actions at timestep t). If student does not make a mistake, copy over original_action.
{% endif %}